"use strict";var Ne=Object.create;var H=Object.defineProperty,Le=Object.defineProperties,Se=Object.getOwnPropertyDescriptor,Oe=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertyNames,K=Object.getOwnPropertySymbols,Ae=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var Z=(e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))W.call(t,n)&&Z(e,n,t[n]);if(K)for(var n of K(t))ee.call(t,n)&&Z(e,n,t[n]);return e},w=(e,t)=>Le(e,Oe(t));var N=(e,t)=>{var n={};for(var a in e)W.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&K)for(var a of K(e))t.indexOf(a)<0&&ee.call(e,a)&&(n[a]=e[a]);return n};var He=(e,t)=>{for(var n in t)H(e,n,{get:t[n],enumerable:!0})},te=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let d of ke(t))!W.call(e,d)&&d!==n&&H(e,d,{get:()=>t[d],enumerable:!(a=Se(t,d))||a.enumerable});return e};var Fe=(e,t,n)=>(n=e!=null?Ne(Ae(e)):{},te(t||!e||!e.__esModule?H(n,"default",{value:e,enumerable:!0}):n,e)),Ue=e=>te(H({},"__esModule",{value:!0}),e);var Qe={};He(Qe,{DropdownItem:()=>ie,DropdownItems:()=>pe,DropdownPopover:()=>Re,DropdownProvider:()=>de,DropdownTrigger:()=>le,useDropdownContext:()=>A,useDropdownDescendants:()=>z,useDropdownItem:()=>ce,useDropdownItems:()=>ue,useDropdownPopover:()=>fe,useDropdownTrigger:()=>se});module.exports=Ue(Qe);var o=Fe(require("react")),ne=require("@reach/auto-id"),re=require("@reach/popover"),v=require("@reach/descendants"),r=require("@reach/utils"),oe="CLEAR_SELECTION_INDEX",$="CLICK_MENU_ITEM",F="CLOSE_MENU",Xe="OPEN_MENU_AT_FIRST_ITEM",Q="OPEN_MENU_AT_INDEX",ae="OPEN_MENU_CLEARED",Y="SEARCH_FOR_ITEM",S="SELECT_ITEM_AT_INDEX",q="SET_BUTTON_ID",B=(0,v.createDescendantContext)("DropdownDescendantContext"),[Ke,A]=(0,r.createContext)("Dropdown"),je={triggerId:null,isExpanded:!1,typeaheadQuery:"",selectionIndex:-1},de=({id:e,children:t})=>{let n=o.useRef(null),a=o.useRef(null),d=o.useRef(null),[E,l]=(0,v.useDescendantsInit)(),p=(0,ne.useId)(e),i=e||(0,r.makeId)("menu",p),D=(0,r.makeId)("menu-button",i),[u,g]=o.useReducer(We,w(s({},je),{triggerId:D})),y=o.useRef(!1),f=o.useRef([]),m=o.useRef(!1),R=o.useRef({x:0,y:0});return o.useEffect(()=>{u.isExpanded?(window.__REACH_DISABLE_TOOLTIPS=!0,window.requestAnimationFrame(()=>{j(a.current)})):window.__REACH_DISABLE_TOOLTIPS=!1},[u.isExpanded]),o.createElement(v.DescendantProvider,{context:B,items:E,set:l},o.createElement(Ke,{dispatch:g,dropdownId:i,dropdownRef:a,mouseDownStartPosRef:R,popoverRef:d,readyToSelect:m,selectCallbacks:f,state:u,triggerClickedRef:y,triggerRef:n},(0,r.isFunction)(t)?t({isExpanded:u.isExpanded,isOpen:u.isExpanded}):t))};de.displayName="DropdownProvider";function se(E){var l=E,{onKeyDown:e,onMouseDown:t,id:n,ref:a}=l,d=N(l,["onKeyDown","onMouseDown","id","ref"]);let{dispatch:p,dropdownId:i,mouseDownStartPosRef:D,triggerClickedRef:u,triggerRef:g,state:{triggerId:y,isExpanded:f}}=A("useDropdownTrigger"),m=(0,r.useComposedRefs)(g,a),R=z(),P=o.useMemo(()=>R.findIndex(T=>!T.disabled),[R]);o.useEffect(()=>{n!=null&&n!==y&&p({type:q,payload:n})},[y,p,n]),o.useEffect(()=>{n==null&&p({type:q,payload:(0,r.makeId)("menu-button",i)})},[i,p,n]);function M(T){switch(T.key){case"ArrowDown":case"ArrowUp":T.preventDefault(),p({type:Q,payload:{index:P}});break;case"Enter":case" ":p({type:Q,payload:{index:P}});break;default:break}}function I(T){(0,r.isRightClick)(T.nativeEvent)||(D.current={x:T.clientX,y:T.clientY},f||(u.current=!0),p(f?{type:F}:{type:ae}))}return{data:{isExpanded:f,controls:i},props:w(s({},d),{ref:m,id:y||void 0,onKeyDown:(0,r.composeEventHandlers)(e,M),onMouseDown:(0,r.composeEventHandlers)(t,I),type:"button"})}}var le=o.forwardRef((a,n)=>{var d=a,{as:e="button"}=d,t=N(d,["as"]);let{props:E}=se(w(s({},t),{ref:n}));return o.createElement(e,s({"data-reach-dropdown-trigger":""},E))});le.displayName="DropdownTrigger";function ce(R){var P=R,{index:e,isLink:t=!1,onClick:n,onDragStart:a,onMouseDown:d,onMouseEnter:E,onMouseLeave:l,onMouseMove:p,onMouseUp:i,onSelect:D,disabled:u,onFocus:g,valueText:y,ref:f}=P,m=N(P,["index","isLink","onClick","onDragStart","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseUp","onSelect","disabled","onFocus","valueText","ref"]);let{dispatch:M,dropdownRef:I,mouseDownStartPosRef:T,readyToSelect:_,selectCallbacks:x,triggerRef:O,state:{selectionIndex:k,isExpanded:h}}=A("useDropdownItem"),C=o.useRef(null),[V,we]=o.useState(y||""),De=o.useCallback(c=>{!y&&(c==null?void 0:c.textContent)&&we(c.textContent)},[y]),U=o.useRef(!1),[G,me]=(0,r.useStatefulRefValue)(C,null),ye=o.useMemo(()=>({element:G,key:V,disabled:u,isLink:t}),[u,G,t,V]),b=(0,v.useDescendant)(ye,B,e),X=b===k&&!u,Ie=(0,r.useComposedRefs)(f,me,De);x.current[b]=D;function J(){j(O.current),D&&D(),M({type:$})}function Te(c){(0,r.isRightClick)(c.nativeEvent)||t&&(u?c.preventDefault():J())}function ge(c){t&&c.preventDefault()}function ve(c){(0,r.isRightClick)(c.nativeEvent)||(t?U.current=!0:c.preventDefault())}function xe(c){let L=(0,r.getOwnerDocument)(I.current);!X&&b!=null&&!u&&((I==null?void 0:I.current)&&I.current!==L.activeElement&&C.current!==L.activeElement&&I.current.focus(),M({type:S,payload:{index:b}}))}function Me(c){M({type:oe})}function _e(c){if(!_.current){let L=8,Ce=Math.abs(c.clientX-T.current.x),be=Math.abs(c.clientY-T.current.y);(Ce>L||be>L)&&(_.current=!0)}!X&&b!=null&&!u&&M({type:S,payload:{index:b,dropdownRef:I}})}function he(){_.current=!0,!X&&b!=null&&!u&&M({type:S,payload:{index:b}})}function Pe(c){if(!(0,r.isRightClick)(c.nativeEvent)){if(!_.current){_.current=!0;return}t?U.current?U.current=!1:C.current&&C.current.click():u||J()}}return o.useEffect(()=>{if(h){let c=window.setTimeout(()=>{_.current=!0},400);return()=>{window.clearTimeout(c)}}else _.current=!1},[h,_]),o.useEffect(()=>{let c=(0,r.getOwnerDocument)(C.current);return c.addEventListener("mouseup",L),()=>{c.removeEventListener("mouseup",L)};function L(){U.current=!1}},[]),{data:{disabled:u},props:w(s({id:Ee(b),tabIndex:-1},m),{ref:Ie,"data-disabled":u?"":void 0,"data-selected":X?"":void 0,"data-valuetext":V,onClick:(0,r.composeEventHandlers)(n,Te),onDragStart:(0,r.composeEventHandlers)(a,ge),onMouseDown:(0,r.composeEventHandlers)(d,ve),onMouseEnter:(0,r.composeEventHandlers)(E,xe),onMouseLeave:(0,r.composeEventHandlers)(l,Me),onMouseMove:(0,r.composeEventHandlers)(p,_e),onFocus:(0,r.composeEventHandlers)(g,he),onMouseUp:(0,r.composeEventHandlers)(i,Pe)})}}var ie=o.forwardRef((a,n)=>{var d=a,{as:e="div"}=d,t=N(d,["as"]);let{props:E}=ce(w(s({},t),{ref:n}));return o.createElement(e,s({"data-reach-dropdown-item":""},E))});ie.displayName="DropdownItem";function ue(d){var E=d,{id:e,onKeyDown:t,ref:n}=E,a=N(E,["id","onKeyDown","ref"]);let{dispatch:l,triggerRef:p,dropdownRef:i,selectCallbacks:D,dropdownId:u,state:{isExpanded:g,triggerId:y,selectionIndex:f,typeaheadQuery:m}}=A("useDropdownItems"),R=z(),P=(0,r.useComposedRefs)(i,n);o.useEffect(()=>{let x=Be(R,m);m&&x!=null&&l({type:S,payload:{index:x,dropdownRef:i}});let O=window.setTimeout(()=>m&&l({type:Y,payload:""}),1e3);return()=>window.clearTimeout(O)},[l,R,m,i]);let M=(0,r.usePrevious)(R.length),I=(0,r.usePrevious)(R[f]),T=(0,r.usePrevious)(f);o.useEffect(()=>{f>R.length-1?l({type:S,payload:{index:R.length-1,dropdownRef:i}}):M!==R.length&&f>-1&&I&&T===f&&R[f]!==I&&l({type:S,payload:{index:R.findIndex(x=>x.key===(I==null?void 0:I.key)),dropdownRef:i}})},[i,l,R,M,I,T,f]);let _=(0,r.composeEventHandlers)(function(O){let{key:k}=O;if(!!g)switch(k){case"Enter":case" ":let h=R.find(C=>C.index===f);h&&!h.disabled&&(O.preventDefault(),h.isLink&&h.element?h.element.click():(j(p.current),D.current[h.index]&&D.current[h.index](),l({type:$})));break;case"Escape":j(p.current),l({type:F});break;case"Tab":O.preventDefault();break;default:if((0,r.isString)(k)&&k.length===1){let C=m+k.toLowerCase();l({type:Y,payload:C})}break}},(0,v.useDescendantKeyDown)(B,{currentIndex:f,orientation:"vertical",rotate:!1,filter:x=>!x.disabled,callback:x=>{l({type:S,payload:{index:x,dropdownRef:i}})},key:"index"}));return{data:{activeDescendant:Ee(f)||void 0,triggerId:y},props:w(s({tabIndex:-1},a),{ref:P,id:u,onKeyDown:(0,r.composeEventHandlers)(t,_)})}}var pe=o.forwardRef((a,n)=>{var d=a,{as:e="div"}=d,t=N(d,["as"]);let{props:E}=ue(w(s({},t),{ref:n}));return o.createElement(e,s({"data-reach-dropdown-items":""},E))});pe.displayName="DropdownItems";function fe(E){var l=E,{onBlur:e,portal:t=!0,position:n,ref:a}=l,d=N(l,["onBlur","portal","position","ref"]);let{triggerRef:p,triggerClickedRef:i,dispatch:D,dropdownRef:u,popoverRef:g,state:{isExpanded:y}}=A("useDropdownPopover"),f=(0,r.useComposedRefs)(g,a);return o.useEffect(()=>{if(!y)return;let m=(0,r.getOwnerDocument)(g.current);function R(P){i.current?i.current=!1:Ve(g.current,P.target)||D({type:F})}return m.addEventListener("mousedown",R),()=>{m.removeEventListener("mousedown",R)}},[i,p,D,u,g,y]),{data:{portal:t,position:n,targetRef:p,isExpanded:y},props:s({ref:f,hidden:!y,onBlur:(0,r.composeEventHandlers)(e,m=>{m.currentTarget.contains(m.relatedTarget)||D({type:F})})},d)}}var Re=o.forwardRef((a,n)=>{var d=a,{as:e="div"}=d,t=N(d,["as"]);let{data:{portal:E,targetRef:l,position:p},props:i}=fe(w(s({},t),{ref:n})),D={"data-reach-dropdown-popover":""};return E?o.createElement(re.Popover,w(s(s({},i),D),{as:e,targetRef:l,position:p,unstable_skipInitialPortalRender:!0})):o.createElement(e,s(s({},i),D))});Re.displayName="DropdownPopover";function Be(e,t=""){if(!t)return null;let n=e.find(a=>{var d,E,l;return a.disabled?!1:(l=(E=(d=a.element)==null?void 0:d.dataset)==null?void 0:E.valuetext)==null?void 0:l.toLowerCase().startsWith(t)});return n?e.indexOf(n):null}function Ee(e){let{dropdownId:t}=A("useItemId");return e!=null&&e>-1?(0,r.makeId)(`option-${e}`,t):void 0}function j(e){e&&e.focus()}function Ve(e,t){return!!(e&&e.contains(t))}function We(e,t={}){switch(t.type){case $:return w(s({},e),{isExpanded:!1,selectionIndex:-1});case F:return w(s({},e),{isExpanded:!1,selectionIndex:-1});case Xe:return w(s({},e),{isExpanded:!0,selectionIndex:0});case Q:return w(s({},e),{isExpanded:!0,selectionIndex:t.payload.index});case ae:return w(s({},e),{isExpanded:!0,selectionIndex:-1});case S:{let{dropdownRef:n={current:null}}=t.payload;if(t.payload.index>=0&&t.payload.index!==e.selectionIndex){if(n.current){let a=(0,r.getOwnerDocument)(n.current);n.current!==(a==null?void 0:a.activeElement)&&n.current.focus()}return w(s({},e),{selectionIndex:t.payload.max!=null?Math.min(Math.max(t.payload.index,0),t.payload.max):Math.max(t.payload.index,0)})}return e}case oe:return w(s({},e),{selectionIndex:-1});case q:return w(s({},e),{triggerId:t.payload});case Y:return typeof t.payload!="undefined"?w(s({},e),{typeaheadQuery:t.payload}):e;default:return e}}function z(){return(0,v.useDescendants)(B)}0&&(module.exports={DropdownItem,DropdownItems,DropdownPopover,DropdownProvider,DropdownTrigger,useDropdownContext,useDropdownDescendants,useDropdownItem,useDropdownItems,useDropdownPopover,useDropdownTrigger});
